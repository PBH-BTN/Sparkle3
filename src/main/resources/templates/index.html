<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{components/common::header}"></head>
<body class="spk-body">
<nav th:replace="~{components/common::navbar}"></nav>

<main class="spk-main">
    <div class="spk-container">
        <!-- Warning Alert -->
        <div class="spk-alert spk-alert--success spk-mb-3">
            <span class="spk-alert__title"><i class="fa-solid fa-road-barrier"></i> 欢迎来到 BTN 3.0</span>
            您正在访问的是 BTN 3.0 服务端，于 2025/12/10 上线。原 BTN 2.0 用户数据现已迁移到 BTN 3.0 版本，但仍有部分用户因长期未登录过而迁移失败。如您出现登陆后数据丢失的问题，请您重新创建用户应用程序。
        </div>
        <div class="spk-alert spk-alert--info spk-mb-3">
            <span class="spk-alert__title"><i class="fa-solid fa-circle-info"></i> BTN 协议版本已升级</span>
            协议版本已升级到 20 版本，新的 BTN 3.0 协议不与旧版本 PeerBanHelper 兼容。请您升级 PeerBanHelper 至最新版本以继续使用。
        </div>
        <div class="spk-alert spk-alert--warning spk-mb-3">
            <span class="spk-alert__title"><i class="fa-solid fa-pause"></i> GitHub 规则同步临时暂停</span>
            PBH-BTN/BTN-Collected-Rules 仓库自动同步临时暂停，我们将在 BTN 服务器接收到新版客户端足够多的数据后再恢复同步。
        </div>
        <div class="spk-alert spk-alert--info spk-mb-3">
            <span class="spk-alert__title"><i class="fa-solid fa-pause"></i> Sparkle Dashboard 临时下线</span>
            原 Grafana Sparkle Dashboard 暂时下线以接受数据迁移。迁移期间，Dashboard 暂不可用。
        </div>


        <!-- Banned Alert -->
        <div class="spk-alert spk-alert--danger spk-mb-3" th:if="${sessionUser.getBannedAt() != null}">
            <span class="spk-alert__title"><i class="fa-solid fa-ban"></i> 账户暂停</span>
            您的 BTN 账户已被管理员停用，原因：<span th:text="${sessionUser.getBannedReason()}">未知</span>。
        </div>

        <!-- Hero Section -->
        <section class="spk-hero">
            <h1 class="spk-hero__title">
                <i class="fas fa-fire"></i> Sparkle
            </h1>
            <p class="spk-hero__subtitle">互联共通，连接你我</p>
            <hr class="spk-hero__divider">
            <p class="spk-hero__text">连接到 BTN 网络，共享威胁情报，获取云端规则</p>
            <a class="spk-btn spk-btn--light spk-btn--lg" th:href="@{/userapp}">
                <i class="fas fa-plus-circle"></i> 创建用户应用
            </a>
        </section>

        <!-- Statistics Section -->
        <section class="spk-mt-4">
            <h2 class="spk-mb-3"><i class="fas fa-chart-line"></i> 网络统计数据</h2>

            <!-- Ban History Statistics -->
            <div class="spk-card spk-mb-3">
                <div class="spk-card__header">
                    <h3 class="spk-card__title"><i class="fas fa-ban"></i> 封禁记录统计</h3>
                </div>
                <div class="spk-card__body">
                    <div class="spk-row">
                        <div class="spk-col-3">
                            <div class="spk-stat">
                                <div class="spk-stat__label">全时</div>
                                <div class="spk-stat__value" th:text="${stats_banhistory_alltime != null ? #numbers.formatInteger(stats_banhistory_alltime, 0, 'COMMA') : '0'}">0</div>
                            </div>
                        </div>
                        <div class="spk-col-3">
                            <div class="spk-stat">
                                <div class="spk-stat__label">30天</div>
                                <div class="spk-stat__value" th:text="${stats_banhistory_30days != null ? #numbers.formatInteger(stats_banhistory_30days, 0, 'COMMA') : '0'}">0</div>
                            </div>
                        </div>
                        <div class="spk-col-3">
                            <div class="spk-stat">
                                <div class="spk-stat__label">7天</div>
                                <div class="spk-stat__value" th:text="${stats_banhistory_7days != null ? #numbers.formatInteger(stats_banhistory_7days, 0, 'COMMA') : '0'}">0</div>
                            </div>
                        </div>
                        <div class="spk-col-3">
                            <div class="spk-stat">
                                <div class="spk-stat__label">24小时</div>
                                <div class="spk-stat__value" th:text="${stats_banhistory_24hours != null ? #numbers.formatInteger(stats_banhistory_24hours, 0, 'COMMA') : '0'}">0</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Swarm Tracker Statistics -->
            <div class="spk-card spk-mb-3">
                <div class="spk-card__header">
                    <h3 class="spk-card__title"><i class="fas fa-network-wired"></i> 跟踪 Peers 统计</h3>
                </div>
                <div class="spk-card__body">
                    <div class="spk-row">
                        <div class="spk-col-3">
                            <div class="spk-stat">
                                <div class="spk-stat__label">30天</div>
                                <div class="spk-stat__value" th:text="${stats_swarmtracker_30days != null ? #numbers.formatInteger(stats_swarmtracker_30days, 0, 'COMMA') : '0'}">0</div>
                            </div>
                        </div>
                        <div class="spk-col-3">
                            <div class="spk-stat">
                                <div class="spk-stat__label">14天</div>
                                <div class="spk-stat__value" th:text="${stats_swarmtracker_14days != null ? #numbers.formatInteger(stats_swarmtracker_14days, 0, 'COMMA') : '0'}">0</div>
                            </div>
                        </div>
                        <div class="spk-col-3">
                            <div class="spk-stat">
                                <div class="spk-stat__label">7天</div>
                                <div class="spk-stat__value" th:text="${stats_swarmtracker_7days != null ? #numbers.formatInteger(stats_swarmtracker_7days, 0, 'COMMA') : '0'}">0</div>
                            </div>
                        </div>
                        <div class="spk-col-3">
                            <div class="spk-stat">
                                <div class="spk-stat__label">24小时</div>
                                <div class="spk-stat__value" th:text="${stats_swarmtracker_24hours != null ? #numbers.formatInteger(stats_swarmtracker_24hours, 0, 'COMMA') : '0'}">0</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- User App Statistics -->
            <div class="spk-card spk-mb-3">
                <div class="spk-card__header">
                    <h3 class="spk-card__title"><i class="fas fa-users"></i> 活动用户应用统计</h3>
                </div>
                <div class="spk-card__body">
                    <div class="spk-row">
                        <div class="spk-col-3">
                            <div class="spk-stat">
                                <div class="spk-stat__label">30天</div>
                                <div class="spk-stat__value" th:text="${stats_userapp_30days != null ? #numbers.formatInteger(stats_userapp_30days, 0, 'COMMA') : '0'}">0</div>
                            </div>
                        </div>
                        <div class="spk-col-3">
                            <div class="spk-stat">
                                <div class="spk-stat__label">14天</div>
                                <div class="spk-stat__value" th:text="${stats_userapp_14days != null ? #numbers.formatInteger(stats_userapp_14days, 0, 'COMMA') : '0'}">0</div>
                            </div>
                        </div>
                        <div class="spk-col-3">
                            <div class="spk-stat">
                                <div class="spk-stat__label">7天</div>
                                <div class="spk-stat__value" th:text="${stats_userapp_7days != null ? #numbers.formatInteger(stats_userapp_7days, 0, 'COMMA') : '0'}">0</div>
                            </div>
                        </div>
                        <div class="spk-col-3">
                            <div class="spk-stat">
                                <div class="spk-stat__label">24小时</div>
                                <div class="spk-stat__value" th:text="${stats_userapp_24hours != null ? #numbers.formatInteger(stats_userapp_24hours, 0, 'COMMA') : '0'}">0</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Content Section -->
        <section class="spk-mt-4">
            <div class="spk-card">
                <div class="spk-card__body spk-text-center">
                    <div class="spk-empty">
                        <i class="fas fa-box-open spk-empty__icon"></i>
                        <p class="spk-empty__text">更多功能正在开发中，敬请期待...</p>
                    </div>
                </div>
            </div>
        </section>
    </div>
</main>

<div th:replace="~{components/common::footer}"></div>
</body>
</html>