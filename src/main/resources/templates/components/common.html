<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<!-- 
    Sparkle Common Components
    This file contains reusable fragments for all pages
-->

<!-- Header Fragment - Include in <head> -->
<head th:fragment="header">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#10b981">
    <title>Sparkle (花火) - BTN Instance</title>
    
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"
          integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
    
    <!-- Sparkle Design System -->
    <link rel="stylesheet" th:href="@{/css/sparkle.css}">
    
    <!-- Font Awesome -->
    <script src="https://kit.fontawesome.com/d1dcdaf5b7.js" crossorigin="anonymous"></script>
    
    <!-- jQuery & Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
            integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-7ymO4nGrkm372HoSbq1OY2DP4pEZnMiA+E0F3zPr+JQQtQ82gQ1HPY3QIVtztVua"
            crossorigin="anonymous"></script>
    
    <!-- Sparkle JS -->
    <script th:src="@{/js/sparkle.js}" defer></script>
</head>
<!-- Navbar Fragment -->
<nav th:fragment="navbar" class="spk-navbar">
    <div class="spk-container spk-container--fluid spk-navbar__inner">
        <a class="spk-navbar__brand" th:href="@{/}">
            <i class="fas fa-fire"></i>
            Sparkle BTN
        </a>
        
        <button class="spk-navbar__toggle" type="button" aria-label="切换导航栏">
            <i class="fas fa-bars"></i>
        </button>
        
        <ul class="spk-navbar__menu">
            <li>
                <a class="spk-navbar__link" th:href="@{/}">
                    <i class="fas fa-home"></i> 首页
                </a>
            </li>
            <li>
                <a class="spk-navbar__link" th:href="@{/userapp}">
                    <i class="fas fa-cog"></i> 用户应用
                </a>
            </li>
            <li>
                <a class="spk-navbar__link" th:href="@{/banhistory}">
                    <i class="fas fa-ban"></i> 封禁记录
                </a>
            </li>
            <li>
                <a class="spk-navbar__link spk-navbar__link--disabled" aria-disabled="true" href="#">
                    <i class="fas fa-upload"></i> 提交记录
                </a>
            </li>
            <li>
                <a class="spk-navbar__link" th:href="@{/client-discovery}">
                    <i class="fas fa-search"></i> 特征发现
                </a>
            </li>
            <li>
                <a class="spk-navbar__link" th:href="@{/swarm-tracker}">
                    <i class="fa-solid fa-list"></i> 种群检视
                </a>
            </li>
            <li>
                <a class="spk-navbar__link" th:href="@{/tracker}">
                    <i class="fas fa-server"></i> Tracker
                </a>
            </li>
            
            <!-- User info -->
            <li class="spk-navbar__user" th:if="${sessionUser != null}">
                <a class="spk-navbar__link" th:href="@{/user/profile}">
                    <img th:src="${sessionUser.getAvatar()}" alt="头像" class="spk-navbar__avatar">
                    <span th:text="${sessionUser.getNickname()}">昵称</span>
                </a>
            </li>
        </ul>
    </div>
</nav>

<!-- Traffic Info Bar Fragment -->
<div th:fragment="traffic-info-bar" class="spk-traffic-info" th:if="${sessionUser != null and sessionUserSwarmStatistics != null}">
    <div class="spk-container spk-container--fluid">
        <div class="spk-traffic-info__inner">
            <div class="spk-traffic-info__item spk-traffic-info__item--upload">
                <i class="fas fa-upload"></i>
                <span class="spk-traffic-info__label">汇报上传:</span>
                <span class="spk-traffic-info__value" th:text="${unitConverter.formatSize(sessionUserSwarmStatistics.sentTrafficSelfReport)}">0 B</span>
            </div>

            <span class="spk-traffic-info__separator">|</span>

            <div class="spk-traffic-info__item spk-traffic-info__item--download">
                <i class="fas fa-download"></i>
                <span class="spk-traffic-info__label">汇报下载:</span>
                <span class="spk-traffic-info__value" th:text="${unitConverter.formatSize(sessionUserSwarmStatistics.receivedTrafficSelfReport)}">0 B</span>
            </div>

            <span class="spk-traffic-info__separator">|</span>

            <div class="spk-traffic-info__item spk-traffic-info__item--upload">
                <i class="fas fa-check-circle"></i>
                <span class="spk-traffic-info__label">确认上传:</span>
                <span class="spk-traffic-info__value" th:text="${unitConverter.formatSize(sessionUserSwarmStatistics.sentTrafficOtherAck)}">0 B</span>
            </div>

            <span class="spk-traffic-info__separator">|</span>

            <div class="spk-traffic-info__item spk-traffic-info__item--download">
                <i class="fas fa-check-circle"></i>
                <span class="spk-traffic-info__label">确认下载:</span>
                <span class="spk-traffic-info__value" th:text="${unitConverter.formatSize(sessionUserSwarmStatistics.receivedTrafficOtherAck)}">0 B</span>
            </div>
        </div>
    </div>
</div>

<!-- Footer Fragment -->
<footer th:fragment="footer" class="spk-footer">
    <div class="spk-container">
        <p class="spk-footer__brand">
            <i class="fas fa-fire"></i>
            <strong>Sparkle (花火)</strong> - BTN v3.0
        </p>
        <p class="spk-footer__sub">
            Made with <i class="fas fa-heart"></i> by <a href="https://github.com/PBH-BTN">PBH-BTN Community</a>
        </p>
    </div>
</footer>

<!-- Alert Fragments -->
<div th:fragment="alert-warning(content)" class="spk-alert spk-alert--warning">
    <span th:utext="${content}"></span>
</div>

<div th:fragment="alert-danger(content)" class="spk-alert spk-alert--danger">
    <span th:utext="${content}"></span>
</div>

<div th:fragment="alert-success(content)" class="spk-alert spk-alert--success">
    <span th:utext="${content}"></span>
</div>

<div th:fragment="alert-info(content)" class="spk-alert spk-alert--info">
    <span th:utext="${content}"></span>
</div>

<!-- Empty State Fragment -->
<div th:fragment="empty-state(icon, title, text)" class="spk-empty">
    <i th:class="${icon} + ' spk-empty__icon'"></i>
    <h4 class="spk-empty__title" th:text="${title}"></h4>
    <p class="spk-empty__text" th:text="${text}"></p>
</div>

</html>